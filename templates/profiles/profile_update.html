{% extends "base.html" %}
{% load static %}
{% load i18n %}

{% block title %} | {% trans "My profile" %} {% endblock %}

{% block css %}
<!-- cropper  -->
<link rel="stylesheet" href="{% static 'css/cropper.css' %}">
{% endblock %}


{% block content %}
    {% if object %}
        <div class="container border border-secondary my-5 ">

              <div class="row justify-content-md-center mt-5">

                <div class="col-md-6 col-sm-12 text-center">
                  <div class="card">
                    <div class="card-body">
                      <h2>Photo</h2>
                      <div class="d-flex flex-column align-items-center text-center">
                        <button type="button" class="btn btn-outline-secondary border-0" data-bs-toggle="modal" data-bs-target="#photoEditModal"><i class="bi bi-pencil"></i></button>

                        <div id="photo-box">
                        {% if object.photo %}
                          <img src="{{ object.photo.url }}" alt="Admin" class="rounded-circle" width="500">
                        {% else %}
                          <p>{% trans "No photo selected" %} </p>
                        {% endif %}
                        </div>

                        {% include "profiles/partials/photo_edit_modal.html" %}
                      </div>
                    </div>
                  </div>
                </div>



              <div class="row justify-content-md-center my-5">
                <div class="col-md-12 col-sm-12">

                  <h2>Skills</h2>
                  <!-- all profile skills -->
                  <form>
                    {% csrf_token %}
                    <div class="htmx-indicator">Updating...</div>
                    <table>

                      <thead> <tr> <th>Skill name</th> <th>Level</th> <th>Actions</th> </tr> </thead>
                      <tbody id="skills" class="sortable"
                      hx-post="{{object.order_skills_url}}" hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}' hx-include="tr" hx-trigger="end" hx-swap="none">
                        {% for skill in object.skills.all %}
                          {% include "profiles/partials/skill-detail.html" %}
                        {% endfor %}
                      </tbody>
                    </table>
                  </form>


                  <h2>adding new skill item</h2>
                  <!-- adding new skill item -->
                  <form>
                    <table>
                      <thead> <tr> <th>New skill name</th> <th>Level</th> <th>Actions</th> </tr> </thead>
                      <tbody >
                        <tr id="newSkill">
                          {% for field in skillform.visible_fields %}
                            <td>
                              {{ field }}
                            </td>
                          {% endfor %}
                          <td>
                            <button type="submit" name="button" class="btn btn-primary"
                              hx-post="{{object.add_skill_url}}" hx-target="#skills"
                              hx-swap="beforeend" hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>
                              <span>+</span>
                          </button>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </form>
                </div>
              </div>
        </div>
      </div>

      {% else %}
        {% include "profiles/create_object.html" %}
      {% endif %}





{% endblock %}


{% block extra_body %}
  <!-- cropper js
  <script type="module" src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js" integrity="sha512-ooSWpxJsiXe6t4+PPjCgYmVfr1NS5QXJACcR/FPpsdm6kqG1FmQ2SVyg2RXeVuCRBLr0lWHnWJP6Zs1Efvxzww==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> -->
  <script src="{% static 'js/cropper.js' %}"></script>
{% endblock %}
