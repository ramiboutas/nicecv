{% extends "base.html" %}
{% load static %}
{% load i18n %}

{% block title %} | {% trans "My profile" %} {% endblock %}

{% block css %}
<!-- cropper  -->
<link rel="stylesheet" href="{% static 'css/cropper.css' %}">
{% endblock %}


{% block content %}
    {% if object %}
        <div class="container border border-secondary my-5 ">

              <div class="row justify-content-md-center mt-5">

                <div class="col-md-6 col-sm-12 text-center">
                  <div class="card">
                    <div class="card-body">
                      <h2>Photo</h2>
                      <div class="d-flex flex-column align-items-center text-center">

                        <div hx-get="{{ object.get_photo_modal_url }}" hx-target="#modals-here"
                        hx-trigger="fullPhotoUploadedEvent from:body" _="on htmx:afterOnLoad wait 10ms then add .show to #photo-modal then add .show to #photo-modal-backdrop"></div>

                        <div hx-get="{{ object.remove_photo_modal_url }}" hx-target="#photo-modal-content" hx-swap="outerHTML"
                          hx-trigger="photoCroppedEvent from:body"></div>

                        <div id="photo-box">
                          {% if object.photo %}
                            {% include "profiles/partials/photo_cropped.html" %}
                          {% endif %}
                        </div>

                        <form>
                            {% csrf_token %}
                            <label class="btn btn-outline-secondary border-0 mx-2" for="file-input">
                              <i class="bi bi-camera"></i>  {% trans "Select photo" %}</label>
                            <input id="file-input" type="file" name="photo" onchange="pollImageToCrop()"  style="visibility: hidden;"
                            hx-post="{{object.upload_full_photo_url}}" hx-encoding='multipart/form-data'
                            hx-trigger="change" hx-swap="none">
                        </form>

                      </div>
                    </div>
                  </div>
                </div>

                <div id="modals-here"></div>

        </div>
      </div>



      {% else %}
        {% include "profiles/create_object.html" %}
      {% endif %}


{% endblock %}




{% block extra_body %}
  <!-- cropper js -->
  <script src="{% static 'js/cropper.js' %}"></script>
{% endblock %}
